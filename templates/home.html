{% extends "base.html" %}
{% load static %}

  {% block content %}
  <!-- Hero + Search -->
  <section class="hero">
    <div class="container search-grid">
      <div>
        <h1 class="h1">Find your perfect PG near <u>college or office</u></h1>
        <p class="sub">Smart filters, verified listings, and real reviews—everything you need for a stress-free move-in.</p>

        <div class="search-card" id="searchCard">
          <label class="field">
            <i class="ri-search-line"></i>
            <input id="q" placeholder="Search area or PG name" />
          </label>
          <label class="field">
            <i class="ri-map-pin-line"></i>
            <select id="city" aria-label="Select city">
              <option value="">All Cities</option>
            </select>
          </label>
          <label class="field">
            <i class="ri-home-6-line"></i>
            <select id="gender">
              <option value="">Any</option>
              <option>Boys</option>
              <option>Girls</option>
              <option>Unisex</option>
            </select>
          </label>
          <label class="field">
            <i class="ri-money-rupee-circle-line"></i>
            <input type="range" id="budget" min="2000" max="25000" step="500" value="12000" />
            <span class="small" id="budgetOut">≤ 12000</span>
          </label>
          <button class="btn btn-search" id="btnSearch">Search PGs</button>
        </div>

        <div class="chips" id="amenitiesBar">
          <span class="small">Filters:</span>
        </div>
      </div>

      <aside class="right-card">
        <div style="display:flex; gap:10px; align-items:flex-start">
          <div class="tag"><i class="ri-sparkling-2-fill"></i> Why PG Finder?</div>
        </div>
        <ul class="small" style="margin:12px 0 0 18px; line-height:1.6">
          <li>Verified photos, amenities & ratings</li>
          <li>One-tap call/WhatsApp to owner</li>
          <li>Favorites & visit scheduling</li>
          <li>No login required</li>
        </ul>

        <!-- MAP -->
        <div id="map" style="height:220px; margin-top:14px; border-radius:12px; overflow:hidden; border:1px solid rgba(255,255,255,.06)"></div>
      </aside>
    </div>
  </section>

  <section class="container">
    <div class="toolbar">
      <div class="count" id="count">0 results</div>
      <div class="sort small">
        Sort by
        <select id="sort">
          <option value="relevance">Relevance</option>
          <option value="price-asc">Price: Low to High</option>
          <option value="price-desc">Price: High to Low</option>
          <option value="rating">Rating</option>
          <option value="distance">Nearest</option>
        </select>
      </div>
    </div>
    <!-- Listing pg's -->
    <div class="grid" id="grid">
      {% for pg in pg_listings %}
      <article class="card" data-id="${p.id}">
    <div class="cover">
     {% for pgimg in pg.images.all %}
  <img src="{{ pgimg.pg_image.url }}" alt="{{ pg.title }}">
{% endfor %}
      <div class="pin">{{pg.address}},{{pg.city}} </div>
    </div>
    <div class="body">
      <div class="title">
        <div>
          <h3>{{pg.title}}</h3>
          <div class="muted">{{pg.sharing_type}} • ⭐ ${p.rating} • ${p.distanceKm} km</div>
        </div>
        <div class="price">₹ {{pg.price_per_month}}</div>
      </div>
      <div class="amen">${p.amenities.slice(0,4).map(a=>`<span>${a}</span>`).join(' ')}</div>
      <div class="actions" style="margin-top:10px">
        <button class="btn-outline " data-view="${p.id}">View details</button>
        <button class="btn" data-book="${p.id}">Book a visit</button>
      </div>
    </div>
  </article>
  {% endfor %}

    </div>
  </section>

  
  <!-- Modal -->
  <div class="modal" id="modal">
    <div class="sheet">
      <div class="sheet-head">
        <strong id="mTitle">PG name</strong>
        <button class="btn-outline" id="mClose"><i class="ri-close-line"></i></button>
      </div>
      <div class="sheet-body">
        <div>
          <div class="gallery" id="mGallery"></div>
          <p class="small" id="mDesc" style="margin-top:10px"></p>
          <div class="amen" id="mAmen"></div>
        </div>
        <div>
          <div class="dl"><i class="ri-map-pin-line"></i> <span id="mLoc"></span></div>
          <div class="dl"><i class="ri-user-3-line"></i> <span id="mGender"></span></div>
          <div class="dl"><i class="ri-star-fill"></i> <span id="mRating"></span></div>
          <div class="dl"><i class="ri-route-line"></i> <span id="mDist"></span></div>
          <div class="dl"><i class="ri-price-tag-3-line"></i> <b id="mPrice"></b> / month</div>
          <div style="display:flex; gap:12px; margin-top:12px">
            <button class="lead" id="btnVisit"><i class="ri-calendar-check-line"></i> Book a Visit</button>
            <button class="btn-outline" id="btnCall"><i class="ri-phone-line"></i> Call / WhatsApp</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Leaflet JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
  integrity="sha256-vh0XQ5Y4LQJ0z9QeW+gGJf4y2tQ0y1C2k3m3b8k7F2s=" crossorigin=""></script>
  
  {% comment %} <script src="{% static 'js/script.js' %}"></script> {% endcomment %}
</body>
</html>

{% endblock %}